{
  if (in == null || pluginFilename == null || pluginFilename.length() < 1) {
    Log.error("Error installing plugin: Input stream was null or pluginFilename was null or had no length.");
    return false;
  }
  try {
    byte[] b=new byte[1024];
    int len;
    int index=pluginFilename.lastIndexOf(File.separator);
    if (index != -1) {
      pluginFilename=pluginFilename.substring(index + 1);
    }
    String absolutePath=pluginDirectory + File.separator + pluginFilename;
    try (OutputStream out=new FileOutputStream(absolutePath + ".part")){
      while ((len=in.read(b)) != -1) {
        out.write(b,0,len);
      }
    }
     new File(absolutePath).delete();
    new File(absolutePath + ".part").renameTo(new File(absolutePath));
    pluginMonitor.run();
  }
 catch (  IOException e) {
    Log.error("Error installing new version of plugin: " + pluginFilename,e);
    return false;
  }
  return true;
}
