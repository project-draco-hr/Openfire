{
  this.mucService=chatservice;
  this.name=roomname;
  this.naturalLanguageName=roomname;
  this.description=roomname;
  this.router=packetRouter;
  this.startTime=System.currentTimeMillis();
  this.creationDate=new Date(startTime);
  this.modificationDate=new Date(startTime);
  this.emptyDate=new Date(startTime);
  this.canOccupantsChangeSubject=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.canOccupantsChangeSubject",false);
  this.maxUsers=MUCPersistenceManager.getIntProperty(mucService.getServiceName(),"room.maxUsers",30);
  this.publicRoom=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.publicRoom",true);
  this.persistent=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.persistent",false);
  this.moderated=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.moderated",false);
  this.membersOnly=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.membersOnly",false);
  this.canOccupantsInvite=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.canOccupantsInvite",false);
  this.canAnyoneDiscoverJID=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.canAnyoneDiscoverJID",true);
  this.logEnabled=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.logEnabled",false);
  this.loginRestrictedToNickname=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.loginRestrictedToNickname",false);
  this.canChangeNickname=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.canChangeNickname",true);
  this.registrationEnabled=MUCPersistenceManager.getBooleanProperty(mucService.getServiceName(),"room.registrationEnabled",true);
  roomHistory=new MUCRoomHistory(this,new HistoryStrategy(mucService.getHistoryStrategy()));
  this.iqOwnerHandler=new IQOwnerHandler(this,packetRouter);
  this.iqAdminHandler=new IQAdminHandler(this,packetRouter);
  this.lockedTime=startTime;
  rolesToBroadcastPresence.add("moderator");
  rolesToBroadcastPresence.add("participant");
  rolesToBroadcastPresence.add("visitor");
  GroupEventDispatcher.addListener(this);
}
