def _GetPathOfProject(qualified_target, spec, options, msvs_version):
    default_config = _GetDefaultConfiguration(spec)
    proj_filename = default_config.get('msvs_existing_vcproj')
    if (not proj_filename):
        proj_filename = ((spec['target_name'] + options.suffix) + msvs_version.ProjectExtension())
    build_file = gyp.common.BuildFile(qualified_target)
    proj_path = os.path.join(os.path.dirname(build_file), proj_filename)
    fix_prefix = None
    if options.generator_output:
        project_dir_path = os.path.dirname(os.path.abspath(proj_path))
        proj_path = os.path.join(options.generator_output, proj_path)
        fix_prefix = gyp.common.RelativePath(project_dir_path, os.path.dirname(proj_path))
    return (proj_path, fix_prefix)
